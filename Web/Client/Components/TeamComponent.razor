@inject NavigationManager navMan;
@inject HttpClient client;
@inject IJSRuntime JSRuntime;
@using Web.Shared.Models

<h1>Team</h1>

<p>Create a team of preferrably all fire pokemon...</p>
<!-- Create the form... -->
<button class="btn btn-primary" @onclick="SelectPreviousTeam">Select</button>

@code {
    public TrainerModel trainer { get; set; }
    private AuthService Auth { get; set; }
    private PokemonService Poke { get; set; }

    public string trainerHandle = string.Empty;
    public string password = string.Empty;

    protected override void OnInitialized()
    {
        Auth = new AuthService();
        Poke = new PokemonService();
    }

    protected override async Task OnInitializedAsync()
    {
        trainerHandle = await Auth.GetCookieAsync(JSRuntime, "Username");

        if (string.IsNullOrEmpty(trainerHandle))
            throw new Exception($"Failed to set TrainerHandle from cookie");

        trainer = await Poke.GetTrainer(client, trainerHandle);
    }


    private void SelectPreviousTeam()
    {
        // todo: get selection from existing teams indicated on UI through DDL, etc...
        Console.WriteLine("Selecting team...");
        navMan.NavigateTo("battle");
    }
}
